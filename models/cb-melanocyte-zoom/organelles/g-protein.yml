---
name: gProtein
image: assets/g-protein.svg
spawn:
  'on':
    selector: "#gprotein-paths-to-receptor path"
    at: 0
    which: random
  # every: 60
  never: true
dieWhenExitingWorld: false
properties:
  size: 0.8
  image_selector: gbody
initialState: away
rules:
  towards:
  - follow:
      selector: "#gprotein-paths-to-receptor path"
      which: random
      direction: backward
      finally:
        switch_state: check_if_bound
  check_if_bound:
  - if:
      fact: world.receptor_bound
    then:
      switch_state: away
    else:
      switch_state: bind_to_receptor
  away:
  - follow:
      selector: "#gprotein-paths-to-receptor path"
      which: nearest
      direction: forward
      finally:
        switch_state: towards
  bind_to_receptor:
  - move_to:
      selector: "#path-away-from-receptor-part"
      finally:
        switch_state: bound
  bound:
  - notify: "bound"
  - set:
      world.receptor_bound: true
  - wait: forever